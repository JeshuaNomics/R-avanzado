<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>22 Debugging | R avanzado</title>
<meta name="author" content="Jeshua Romero Guadarrama">
<meta name="generator" content="bookdown 0.24.4 with bs4_book()">
<meta property="og:title" content="22 Debugging | R avanzado">
<meta property="og:type" content="book">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="22 Debugging | R avanzado">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.11/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1.9000/transition.js"></script><script src="libs/bs3compat-0.3.1.9000/tabs.js"></script><script src="libs/bs3compat-0.3.1.9000/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-141212623-1"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-141212623-1');
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><meta name="description" content="22.1 Introduction   What do you do when R code throws an unexpected error? What tools do you have to find and fix the problem? This chapter will teach you the art and science of debugging,...">
<meta property="og:description" content="22.1 Introduction   What do you do when R code throws an unexpected error? What tools do you have to find and fix the problem? This chapter will teach you the art and science of debugging,...">
<meta name="twitter:description" content="22.1 Introduction   What do you do when R code throws an unexpected error? What tools do you have to find and fix the problem? This chapter will teach you the art and science of debugging,...">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">R avanzado</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Welcome</a></li>
<li><a class="" href="preface.html">Preface</a></li>
<li><a class="" href="introduction.html"><span class="header-section-number">1</span> Introduction</a></li>
<li class="book-part">Foundations</li>
<li><a class="" href="foundations-intro.html">Introduction</a></li>
<li><a class="" href="names-values.html"><span class="header-section-number">2</span> Names and values</a></li>
<li><a class="" href="vectors-chap.html"><span class="header-section-number">3</span> Vectors</a></li>
<li><a class="" href="subsetting.html"><span class="header-section-number">4</span> Subsetting</a></li>
<li><a class="" href="control-flow.html"><span class="header-section-number">5</span> Control flow</a></li>
<li><a class="" href="functions.html"><span class="header-section-number">6</span> Functions</a></li>
<li><a class="" href="environments.html"><span class="header-section-number">7</span> Environments</a></li>
<li><a class="" href="conditions.html"><span class="header-section-number">8</span> Conditions</a></li>
<li class="book-part">Functional programming</li>
<li><a class="" href="fp.html">Introduction</a></li>
<li><a class="" href="functionals.html"><span class="header-section-number">9</span> Functionals</a></li>
<li><a class="" href="function-factories.html"><span class="header-section-number">10</span> Function factories</a></li>
<li><a class="" href="function-operators.html"><span class="header-section-number">11</span> Function operators</a></li>
<li class="book-part">Object-oriented programming</li>
<li><a class="" href="oo.html">Introduction</a></li>
<li><a class="" href="base-types.html"><span class="header-section-number">12</span> Base types</a></li>
<li><a class="" href="s3.html"><span class="header-section-number">13</span> S3</a></li>
<li><a class="" href="r6.html"><span class="header-section-number">14</span> R6</a></li>
<li><a class="" href="s4.html"><span class="header-section-number">15</span> S4</a></li>
<li><a class="" href="oo-tradeoffs.html"><span class="header-section-number">16</span> Trade-offs</a></li>
<li class="book-part">Metaprogramming</li>
<li><a class="" href="metaprogramming.html">Introduction</a></li>
<li><a class="" href="meta-big-picture.html"><span class="header-section-number">17</span> Big picture</a></li>
<li><a class="" href="expressions.html"><span class="header-section-number">18</span> Expressions</a></li>
<li><a class="" href="quasiquotation.html"><span class="header-section-number">19</span> Quasiquotation</a></li>
<li><a class="" href="evaluation.html"><span class="header-section-number">20</span> Evaluation</a></li>
<li><a class="" href="translation.html"><span class="header-section-number">21</span> Translating R code</a></li>
<li class="book-part">Techniques</li>
<li><a class="" href="techniques.html">Introduction</a></li>
<li><a class="active" href="debugging.html"><span class="header-section-number">22</span> Debugging</a></li>
<li><a class="" href="perf-measure.html"><span class="header-section-number">23</span> Measuring performance</a></li>
<li><a class="" href="perf-improve.html"><span class="header-section-number">24</span> Improving performance</a></li>
<li><a class="" href="rcpp.html"><span class="header-section-number">25</span> Rewriting R code in C++</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/hadley/adv-r">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="debugging" class="section level1" number="22">
<h1>
<span class="header-section-number">22</span> Debugging<a class="anchor" aria-label="anchor" href="#debugging"><i class="fas fa-link"></i></a>
</h1>
<div id="introduction-21" class="section level2" number="22.1">
<h2>
<span class="header-section-number">22.1</span> Introduction<a class="anchor" aria-label="anchor" href="#introduction-21"><i class="fas fa-link"></i></a>
</h2>
<p>

</p>
<p>What do you do when R code throws an unexpected error? What tools do you have to find and fix the problem? This chapter will teach you the art and science of debugging, starting with a general strategy, then following up with specific tools.</p>
<p>I’ll show the tools provided by both R and the RStudio IDE. I recommend using RStudio’s tools if possible, but I’ll also show you the equivalents that work everywhere. You may also want to refer to the official <a href="https://support.rstudio.com/hc/en-us/articles/205612627-Debugging-with-RStudio">RStudio debugging documentation</a> which always reflects the latest version of RStudio.</p>
<p>NB: You shouldn’t need to use these tools when writing <em>new</em> functions. If you find yourself using them frequently with new code, reconsider your approach. Instead of trying to write one big function all at once, work interactively on small pieces. If you start small, you can quickly identify why something doesn’t work, and don’t need sophisticated debugging tools.</p>
<div id="outline-20" class="section level3 unnumbered">
<h3>Outline<a class="anchor" aria-label="anchor" href="#outline-20"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li><p>Section <a href="debugging.html#debugging-strategy">22.2</a> outlines a general strategy for
finding and fixing errors.</p></li>
<li><p>Section <a href="debugging.html#traceback">22.3</a> introduces you to the <code><a href="https://rdrr.io/r/base/traceback.html">traceback()</a></code> function
which helps you locate exactly where an error occurred.</p></li>
<li><p>Section <a href="debugging.html#browser">22.4</a> shows you how to pause the execution of a function
and launch environment where you can interactively explore what’s happening.</p></li>
<li><p>Section <a href="debugging.html#non-interactive-debugging">22.5</a> discusses the challenging problem
of debugging when you’re running code non-interactively.</p></li>
<li><p>Section <a href="debugging.html#non-error-failures">22.6</a> discusses a handful of non-error problems
that occassionally also need debugging.</p></li>
</ul>
</div>
</div>
<div id="debugging-strategy" class="section level2" number="22.2">
<h2>
<span class="header-section-number">22.2</span> Overall approach<a class="anchor" aria-label="anchor" href="#debugging-strategy"><i class="fas fa-link"></i></a>
</h2>
<blockquote>
<p>Finding your bug is a process of confirming the many things
that you believe are true — until you find one which is not
true.</p>
<p>—Norm Matloff</p>
</blockquote>
<p>Finding the root cause of a problem is always challenging. Most bugs are subtle and hard to find because if they were obvious, you would’ve avoided them in the first place. A good strategy helps. Below I outline a four step process that I have found useful:</p>
<ol style="list-style-type: decimal">
<li>
<p><strong>Google!</strong></p>
<p>Whenever you see an error message, start by googling it. If you’re lucky,
you’ll discover that it’s a common error with a known solution. When
googling, improve your chances of a good match by removing any variable
names or values that are specific to your problem.</p>
<p>You can automate this process with the errorist<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;James Balamuta, &lt;em&gt;Errorist: Automatically Search Errors or Warnings&lt;/em&gt;, 2018, &lt;a href="https://github.com/coatless/errorist" role="doc-biblioref"&gt;https://github.com/coatless/errorist&lt;/a&gt;.&lt;/p&gt;'><sup>107</sup></a></span> and searcher<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;James Balamuta, &lt;em&gt;Searcher: Query Search Interfaces&lt;/em&gt;, 2018, &lt;a href="https://github.com/coatless/searcher" role="doc-biblioref"&gt;https://github.com/coatless/searcher&lt;/a&gt;.&lt;/p&gt;'><sup>108</sup></a></span> packages. See their websites for more details.</p>
</li>
<li>
<p><strong>Make it repeatable</strong></p>
<p>To find the root cause of an error, you’re going to need to execute the
code many times as you consider and reject hypotheses. To make that
iteration as quick possible, it’s worth some upfront investment to make
the problem both easy and fast to reproduce.</p>
<p>Start by creating a reproducible example (Section <a href="introduction.html#getting-help">1.7</a>).
Next, make the example minimal by removing code and simplifying data.
As you do this, you may discover inputs that don’t trigger the error.
Make note of them: they will be helpful when diagnosing the root cause.</p>
<p>If you’re using automated testing, this is also a good time to create an
automated test case. If your existing test coverage is low, take the
opportunity to add some nearby tests to ensure that existing good behaviour
is preserved. This reduces the chances of creating a new bug.</p>
</li>
<li>
<p><strong>Figure out where it is</strong></p>
<p>If you’re lucky, one of the tools in the following section will help you to
quickly identify the line of code that’s causing the bug. Usually, however,
you’ll have to think a bit more about the problem. It’s a great idea to
adopt the scientific method. Generate hypotheses, design experiments to test
them, and record your results. This may seem like a lot of work, but a
systematic approach will end up saving you time. I often waste a lot of time
relying on my intuition to solve a bug (“oh, it must be an off-by-one error,
so I’ll just subtract 1 here”), when I would have been better off taking a
systematic approach.</p>
<p>If this fails, you might need to ask help from someone else. If you’ve
followed the previous step, you’ll have a small example that’s easy to
share with others. That makes it much easier for other people to look at
the problem, and more likely to help you find a solution.</p>
</li>
<li>
<p><strong>Fix it and test it</strong></p>
<p>Once you’ve found the bug, you need to figure out how to fix it and to check
that the fix actually worked. Again, it’s very useful to have automated
tests in place. Not only does this help to ensure that you’ve actually fixed
the bug, it also helps to ensure you haven’t introduced any new bugs in the
process. In the absence of automated tests, make sure to carefully record
the correct output, and check against the inputs that previously failed.</p>
</li>
</ol>
</div>
<div id="traceback" class="section level2" number="22.3">
<h2>
<span class="header-section-number">22.3</span> Locating errors<a class="anchor" aria-label="anchor" href="#traceback"><i class="fas fa-link"></i></a>
</h2>
<p>
</p>
<p>Once you’ve made the error repeatable, the next step is to figure out where it comes from. The most important tool for this part of the process is <code><a href="https://rdrr.io/r/base/traceback.html">traceback()</a></code>, which shows you the sequence of calls (also known as the call stack, Section <a href="environments.html#call-stack">7.5</a>) that lead to the error.</p>
<p>Here’s a simple example: you can see that <code>f()</code> calls <code>g()</code> calls <code>h()</code> calls <code>i()</code>, which checks if its argument is numeric:</p>
<div class="sourceCode" id="cb956"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">f</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">a</span><span class="op">)</span> <span class="fu">g</span><span class="op">(</span><span class="va">a</span><span class="op">)</span>
<span class="va">g</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">b</span><span class="op">)</span> <span class="fu">h</span><span class="op">(</span><span class="va">b</span><span class="op">)</span>
<span class="va">h</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">c</span><span class="op">)</span> <span class="fu">i</span><span class="op">(</span><span class="va">c</span><span class="op">)</span>
<span class="va">i</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">d</span><span class="op">)</span> <span class="op">{</span>
  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">is.numeric</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
    <span class="kw"><a href="https://rdrr.io/r/base/stop.html">stop</a></span><span class="op">(</span><span class="st">"`d` must be numeric"</span>, call. <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
  <span class="op">}</span>
  <span class="va">d</span> <span class="op">+</span> <span class="fl">10</span>
<span class="op">}</span></code></pre></div>
<p>When we run <code>f("a")</code> code in RStudio we see:</p>
<div class="inline-figure"><img src="screenshots/debugging/rstudio-error.png" width="100%" style="display: block; margin: auto;"></div>
<p>Two options appear to the right of the error message: “Show Traceback” and “Rerun with Debug.” If you click “Show traceback” you see:</p>
<div class="inline-figure"><img src="screenshots/debugging/rstudio-traceback.png" width="100%" style="display: block; margin: auto;"></div>
<p>If you’re not using RStudio, you can use <code><a href="https://rdrr.io/r/base/traceback.html">traceback()</a></code> to get the same information (sans pretty formatting):</p>
<div class="sourceCode" id="cb957"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/traceback.html">traceback</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; 5: stop("`d` must be numeric", call. = FALSE) at debugging.R#6</span>
<span class="co">#&gt; 4: i(c) at debugging.R#3</span>
<span class="co">#&gt; 3: h(b) at debugging.R#2</span>
<span class="co">#&gt; 2: g(a) at debugging.R#1</span>
<span class="co">#&gt; 1: f("a")</span></code></pre></div>
<p>NB: You read the <code><a href="https://rdrr.io/r/base/traceback.html">traceback()</a></code> output from bottom to top: the initial call is <code>f()</code>, which calls <code>g()</code>, then <code>h()</code>, then <code>i()</code>, which triggers the error. If you’re calling code that you <code><a href="https://rdrr.io/r/base/source.html">source()</a></code>d into R, the traceback will also display the location of the function, in the form <code>filename.r#linenumber</code>. These are clickable in RStudio, and will take you to the corresponding line of code in the editor.</p>
<div id="debug-lazy" class="section level3" number="22.3.1">
<h3>
<span class="header-section-number">22.3.1</span> Lazy evaluation<a class="anchor" aria-label="anchor" href="#debug-lazy"><i class="fas fa-link"></i></a>
</h3>
<p>One drawback to <code><a href="https://rdrr.io/r/base/traceback.html">traceback()</a></code> is that it always linearises the call tree, which can be confusing if there is much lazy evaluation involved (Section <a href="environments.html#lazy-call-stack">7.5.2</a>). For example, take the following example where the error happens when evaluating the first argument to <code>f()</code>:</p>
<div class="sourceCode" id="cb958"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">j</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="fu">k</span><span class="op">(</span><span class="op">)</span>
<span class="va">k</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="kw"><a href="https://rdrr.io/r/base/stop.html">stop</a></span><span class="op">(</span><span class="st">"Oops!"</span>, call. <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu">f</span><span class="op">(</span><span class="fu">j</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Error: Oops!</span></code></pre></div>
<div class="sourceCode" id="cb959"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/traceback.html">traceback</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; 7: stop("Oops!") at #1</span>
<span class="co">#&gt; 6: k() at #1</span>
<span class="co">#&gt; 5: j() at debugging.R#1</span>
<span class="co">#&gt; 4: i(c) at debugging.R#3</span>
<span class="co">#&gt; 3: h(b) at debugging.R#2</span>
<span class="co">#&gt; 2: g(a) at debugging.R#1</span>
<span class="co">#&gt; 1: f(j())</span></code></pre></div>
<p>You can using <code><a href="https://rlang.r-lib.org/reference/with_abort.html">rlang::with_abort()</a></code> and <code><a href="https://rlang.r-lib.org/reference/last_error.html">rlang::last_trace()</a></code> to see the call tree. Here, I think it makes it much easier to see the source of the problem. Look at the last branch of the call tree to see that the error comes from <code>j()</code> calling <code>k()</code>.</p>
<div class="sourceCode" id="cb960"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">rlang</span><span class="fu">::</span><span class="fu"><a href="https://rlang.r-lib.org/reference/with_abort.html">with_abort</a></span><span class="op">(</span><span class="fu">f</span><span class="op">(</span><span class="fu">j</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Error: Oops!</span>
<span class="fu">rlang</span><span class="fu">::</span><span class="fu"><a href="https://rlang.r-lib.org/reference/last_error.html">last_trace</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; Error: Can't show last error because no error was recorded yet</span></code></pre></div>
<p>NB: <code><a href="https://rlang.r-lib.org/reference/last_error.html">rlang::last_trace()</a></code> is ordered in the opposite way to <code><a href="https://rdrr.io/r/base/traceback.html">traceback()</a></code>. We’ll come back to that issue in Section <a href="debugging.html#call-stack-ordering">22.4.2.4</a>.</p>
</div>
</div>
<div id="browser" class="section level2" number="22.4">
<h2>
<span class="header-section-number">22.4</span> Interactive debugger<a class="anchor" aria-label="anchor" href="#browser"><i class="fas fa-link"></i></a>
</h2>
<p>
</p>
<p>Sometimes, the precise location of the error is enough to let you track it down and fix it. Frequently, however, you need more information, and the easiest way to get it is with the interactive debugger which allows you to pause execution of a function and interactively explore its state.</p>
<p>If you’re using RStudio, the easiest way to enter the interactive debugger is through RStudio’s “Rerun with Debug” tool. This reruns the command that created the error, pausing execution where the error occurred. Otherwise, you can insert a call to <code><a href="https://rdrr.io/r/base/browser.html">browser()</a></code> where you want to pause, and re-run the function. For example, we could insert a call <code><a href="https://rdrr.io/r/base/browser.html">browser()</a></code> in <code>g()</code>:</p>
<div class="sourceCode" id="cb961"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">g</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">b</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/base/browser.html">browser</a></span><span class="op">(</span><span class="op">)</span>
  <span class="fu">h</span><span class="op">(</span><span class="va">b</span><span class="op">)</span>
<span class="op">}</span>
<span class="fu">f</span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></code></pre></div>
<p><code><a href="https://rdrr.io/r/base/browser.html">browser()</a></code> is just a regular function call which means that you can run it conditionally by wrapping it in an <code>if</code> statement:</p>
<div class="sourceCode" id="cb962"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">g</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">b</span><span class="op">)</span> <span class="op">{</span>
  <span class="kw">if</span> <span class="op">(</span><span class="va">b</span> <span class="op">&lt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/r/base/browser.html">browser</a></span><span class="op">(</span><span class="op">)</span>
  <span class="op">}</span>
  <span class="fu">h</span><span class="op">(</span><span class="va">b</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>In either case, you’ll end up in an interactive environment <em>inside</em> the function where you can run arbitrary R code to explore the current state. You’ll know when you’re in the interactive debugger because you get a special prompt:</p>
<pre><code>Browse[1]&gt; </code></pre>
<p>In RStudio, you’ll see the corresponding code in the editor (with the statement that will be run next highlighted), objects in the current environment in the Environment pane, and the call stack in the Traceback pane.</p>
<div id="browser-commands" class="section level3" number="22.4.1">
<h3>
<span class="header-section-number">22.4.1</span> <code>browser()</code> commands<a class="anchor" aria-label="anchor" href="#browser-commands"><i class="fas fa-link"></i></a>
</h3>
<p>As well as allowing you to run regular R code, <code><a href="https://rdrr.io/r/base/browser.html">browser()</a></code> provides a few special commands. You can use them by either typing short text commands, or by clicking a button in the RStudio toolbar, Figure <a href="debugging.html#fig:debug-toolbar">22.1</a>:</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:debug-toolbar"></span>
<img src="screenshots/debug-toolbar.png" alt="RStudio debugging toolbar" width="50%"><p class="caption">
Figure 22.1: RStudio debugging toolbar
</p>
</div>
<ul>
<li><p>Next, <code>n</code>: executes the next step in the function. If you have a
variable named <code>n</code>, you’ll need <code>print(n)</code> to display its value.</p></li>
<li><p>Step into, <img src="screenshots/step-into.png" width="20"> or <code>s</code>:
works like next, but if the next step is a function, it will step into that
function so you can explore it interactively.</p></li>
<li><p>Finish, <img src="screenshots/finish-loop.png" width="20"> or <code>f</code>:
finishes execution of the current loop or function.</p></li>
<li><p>Continue, <code>c</code>: leaves interactive debugging and continues regular execution
of the function. This is useful if you’ve fixed the bad state and want to
check that the function proceeds correctly.</p></li>
<li><p>Stop, <code>Q</code>: stops debugging, terminates the function, and returns to the global
workspace. Use this once you’ve figured out where the problem is, and you’re
ready to fix it and reload the code.</p></li>
</ul>
<p>There are two other slightly less useful commands that aren’t available in the toolbar:</p>
<ul>
<li><p>Enter: repeats the previous command. I find this too easy to activate
accidentally, so I turn it off using <code>options(browserNLdisabled = TRUE)</code>.
</p></li>
<li><p><code>where</code>: prints stack trace of active calls (the interactive equivalent of
<code>traceback</code>).</p></li>
</ul>
</div>
<div id="alternatives" class="section level3" number="22.4.2">
<h3>
<span class="header-section-number">22.4.2</span> Alternatives<a class="anchor" aria-label="anchor" href="#alternatives"><i class="fas fa-link"></i></a>
</h3>
<p>There are three alternatives to using <code><a href="https://rdrr.io/r/base/browser.html">browser()</a></code>: setting breakpoints in RStudio, <code>options(error = recover)</code>, and <code><a href="https://rdrr.io/r/base/debug.html">debug()</a></code> and other related functions.</p>
<div id="breakpoints" class="section level4" number="22.4.2.1">
<h4>
<span class="header-section-number">22.4.2.1</span> Breakpoints<a class="anchor" aria-label="anchor" href="#breakpoints"><i class="fas fa-link"></i></a>
</h4>
<p></p>
<p>In RStudio, you can set a breakpoint by clicking to the left of the line number, or pressing <code>Shift + F9</code>. Breakpoints behave similarly to <code><a href="https://rdrr.io/r/base/browser.html">browser()</a></code> but they are easier to set (one click instead of nine key presses), and you don’t run the risk of accidentally including a <code><a href="https://rdrr.io/r/base/browser.html">browser()</a></code> statement in your source code. There are two small downsides to breakpoints:</p>
<ul>
<li><p>There are a few unusual situations in which breakpoints will not work.
Read <a href="http://www.rstudio.com/ide/docs/debugging/breakpoint-troubleshooting">breakpoint troubleshooting</a> for more details.</p></li>
<li><p>RStudio currently does not support conditional breakpoints.</p></li>
</ul>
</div>
<div id="recover" class="section level4" number="22.4.2.2">
<h4>
<span class="header-section-number">22.4.2.2</span> <code>recover()</code><a class="anchor" aria-label="anchor" href="#recover"><i class="fas fa-link"></i></a>
</h4>
<p>
</p>
<p>Another way to activate <code><a href="https://rdrr.io/r/base/browser.html">browser()</a></code> is to use <code>options(error = recover)</code>. Now when you get an error, you’ll get an interactive prompt that displays the traceback and gives you the ability to interactively debug inside any of the frames:</p>
<div class="sourceCode" id="cb964"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>error <span class="op">=</span> <span class="va">recover</span><span class="op">)</span>
<span class="fu">f</span><span class="op">(</span><span class="st">"x"</span><span class="op">)</span>
<span class="co">#&gt; Error: `d` must be numeric</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Enter a frame number, or 0 to exit   </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; 1: f("x")</span>
<span class="co">#&gt; 2: debugging.R#1: g(a)</span>
<span class="co">#&gt; 3: debugging.R#2: h(b)</span>
<span class="co">#&gt; 4: debugging.R#3: i(c)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Selection:</span></code></pre></div>
<p>You can return to default error handling with <code>options(error = NULL)</code>.</p>
</div>
<div id="debug" class="section level4" number="22.4.2.3">
<h4>
<span class="header-section-number">22.4.2.3</span> <code>debug()</code><a class="anchor" aria-label="anchor" href="#debug"><i class="fas fa-link"></i></a>
</h4>
<p>Another approach is to call a function that inserts the <code><a href="https://rdrr.io/r/base/browser.html">browser()</a></code> call for you:</p>
<ul>
<li><p><code><a href="https://rdrr.io/r/base/debug.html">debug()</a></code> inserts a browser statement in the first line of the specified
function. <code><a href="https://rdrr.io/r/base/debug.html">undebug()</a></code> removes it. Alternatively, you can use <code><a href="https://rdrr.io/r/base/debug.html">debugonce()</a></code>
to browse only on the next run.</p></li>
<li><p><code><a href="https://rdrr.io/r/utils/findLineNum.html">utils::setBreakpoint()</a></code> works similarly, but instead of taking a function
name, it takes a file name and line number and finds the appropriate function
for you.</p></li>
</ul>
<p>These two functions are both special cases of <code><a href="https://rdrr.io/r/base/trace.html">trace()</a></code>, which inserts arbitrary code at any position in an existing function. <code><a href="https://rdrr.io/r/base/trace.html">trace()</a></code> is occasionally useful when you’re debugging code that you don’t have the source for. To remove tracing from a function, use <code><a href="https://rdrr.io/r/base/trace.html">untrace()</a></code>. You can only perform one trace per function, but that one trace can call multiple functions.</p>
</div>
<div id="call-stack-ordering" class="section level4" number="22.4.2.4">
<h4>
<span class="header-section-number">22.4.2.4</span> Call stack<a class="anchor" aria-label="anchor" href="#call-stack-ordering"><i class="fas fa-link"></i></a>
</h4>
<p></p>
<p>Unfortunately, the call stacks printed by <code><a href="https://rdrr.io/r/base/traceback.html">traceback()</a></code>, <code><a href="https://rdrr.io/r/base/browser.html">browser()</a></code> &amp; <code>where</code>, and <code><a href="https://rdrr.io/r/utils/recover.html">recover()</a></code> are not consistent. The following table shows how the call stacks from a simple nested set of calls are displayed by the three tools. The numbering is different between <code><a href="https://rdrr.io/r/base/traceback.html">traceback()</a></code> and <code>where</code>, and <code><a href="https://rdrr.io/r/utils/recover.html">recover()</a></code> displays calls in the opposite order.</p>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="left"><code><a href="https://rdrr.io/r/base/traceback.html">traceback()</a></code></th>
<th align="left"><code>where</code></th>
<th align="left"><code><a href="https://rdrr.io/r/utils/recover.html">recover()</a></code></th>
<th align="left">rlang functions</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><code>5: stop("...")</code></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"><code>4: i(c)</code></td>
<td align="left"><code>where 1: i(c)</code></td>
<td align="left"><code>1: f()</code></td>
<td align="left"><code>1. └─global::f(10)</code></td>
</tr>
<tr class="odd">
<td align="left"><code>3: h(b)</code></td>
<td align="left"><code>where 2: h(b)</code></td>
<td align="left"><code>2: g(a)</code></td>
<td align="left"><code>2.   └─global::g(a)</code></td>
</tr>
<tr class="even">
<td align="left"><code>2: g(a)</code></td>
<td align="left"><code>where 3: g(a)</code></td>
<td align="left"><code>3: h(b)</code></td>
<td align="left"><code>3.     └─global::h(b)</code></td>
</tr>
<tr class="odd">
<td align="left"><code>1: f("a")</code></td>
<td align="left"><code>where 4: f("a")</code></td>
<td align="left"><code>4: i("a")</code></td>
<td align="left"><code>4.       └─global::i("a")</code></td>
</tr>
</tbody>
</table></div>
<p>RStudio displays calls in the same order as <code><a href="https://rdrr.io/r/base/traceback.html">traceback()</a></code>. rlang functions use the same ordering and numbering as <code><a href="https://rdrr.io/r/utils/recover.html">recover()</a></code>, but also use indenting to reinforce the hierarchy of calls.</p>
</div>
</div>
<div id="debug-compiled" class="section level3" number="22.4.3">
<h3>
<span class="header-section-number">22.4.3</span> Compiled code<a class="anchor" aria-label="anchor" href="#debug-compiled"><i class="fas fa-link"></i></a>
</h3>
<p></p>
<p>It is also possible to use an interactive debugger (gdb or lldb) for compiled code (like C or C++). Unfortunately that’s beyond the scope of this book, but there are a few resources that you might find useful:</p>
<ul>
<li><a href="http://r-pkgs.had.co.nz/src.html#src-debugging" class="uri">http://r-pkgs.had.co.nz/src.html#src-debugging</a></li>
<li><a href="https://github.com/wch/r-debug/blob/master/debugging-r.md" class="uri">https://github.com/wch/r-debug/blob/master/debugging-r.md</a></li>
<li><a href="http://kevinushey.github.io/blog/2015/04/05/debugging-with-valgrind/" class="uri">http://kevinushey.github.io/blog/2015/04/05/debugging-with-valgrind/</a></li>
<li><a href="https://www.jimhester.com/2018/08/22/debugging-rstudio/" class="uri">https://www.jimhester.com/2018/08/22/debugging-rstudio/</a></li>
</ul>
</div>
</div>
<div id="non-interactive-debugging" class="section level2" number="22.5">
<h2>
<span class="header-section-number">22.5</span> Non-interactive debugging<a class="anchor" aria-label="anchor" href="#non-interactive-debugging"><i class="fas fa-link"></i></a>
</h2>
<p></p>
<p>Debugging is most challenging when you can’t run code interactively, typically because it’s part of some pipeline run automatically (possibly on another computer), or because the error doesn’t occur when you run same code interactively. This can be extremely frustrating!</p>
<p>This section will give you some useful tools, but don’t forget the general strategy in Section <a href="debugging.html#debugging-strategy">22.2</a>. When you can’t explore interactively, it’s particularly important to spend some time making the problem as small as possible so you can iterate quickly. Sometimes <code>callr::r(f, list(1, 2))</code> can be useful; this calls <code>f(1, 2)</code> in a fresh session, and can help to reproduce the problem.</p>
<p>You might also want to double check for these common issues:</p>
<ul>
<li><p>Is the global environment different? Have you loaded different packages?
Are objects left from previous sessions causing differences?</p></li>
<li><p>Is the working directory different?</p></li>
<li><p>Is the <code>PATH</code> environment variable, which determines where external
commands (like <code>git</code>) are found, different?</p></li>
<li><p>Is the <code>R_LIBS</code> environment variable, which determines where <code><a href="https://rdrr.io/r/base/library.html">library()</a></code>
looks for packages, different?</p></li>
</ul>
<div id="dump.frames" class="section level3" number="22.5.1">
<h3>
<span class="header-section-number">22.5.1</span> <code>dump.frames()</code><a class="anchor" aria-label="anchor" href="#dump.frames"><i class="fas fa-link"></i></a>
</h3>
<p><code><a href="https://rdrr.io/r/utils/debugger.html">dump.frames()</a></code> is the equivalent to <code><a href="https://rdrr.io/r/utils/recover.html">recover()</a></code> for non-interactive code; it saves a <code>last.dump.rda</code> file in the working directory. Later, an interactive session, you can <code>load("last.dump.rda"); debugger()</code> to enter an interactive debugger with the same interface as <code><a href="https://rdrr.io/r/utils/recover.html">recover()</a></code>. This lets you “cheat,” interactively debugging code that was run non-interactively.</p>
<div class="sourceCode" id="cb965"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># In batch R process ----</span>
<span class="va">dump_and_quit</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span>
  <span class="co"># Save debugging info to file last.dump.rda</span>
  <span class="fu"><a href="https://rdrr.io/r/utils/debugger.html">dump.frames</a></span><span class="op">(</span>to.file <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
  <span class="co"># Quit R with error status</span>
  <span class="fu"><a href="https://rdrr.io/r/base/quit.html">q</a></span><span class="op">(</span>status <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="op">}</span>
<span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>error <span class="op">=</span> <span class="va">dump_and_quit</span><span class="op">)</span>

<span class="co"># In a later interactive session ----</span>
<span class="fu"><a href="https://rdrr.io/r/base/load.html">load</a></span><span class="op">(</span><span class="st">"last.dump.rda"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/debugger.html">debugger</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
</div>
<div id="print-debugging" class="section level3" number="22.5.2">
<h3>
<span class="header-section-number">22.5.2</span> Print debugging<a class="anchor" aria-label="anchor" href="#print-debugging"><i class="fas fa-link"></i></a>
</h3>
<p></p>
<p>If <code><a href="https://rdrr.io/r/utils/debugger.html">dump.frames()</a></code> doesn’t help, a good fallback is <strong>print debugging</strong>, where you insert numerous print statements to precisely locate the problem, and see the values of important variables. Print debugging is slow and primitive, but it always works, so it’s particularly useful if you can’t get a good traceback. Start by inserting coarse-grained markers, and then make them progressively more fine-grained as you determine exactly where the problem is.</p>
<div class="sourceCode" id="cb966"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">f</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">a</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"f()\n"</span><span class="op">)</span>
  <span class="fu">g</span><span class="op">(</span><span class="va">a</span><span class="op">)</span>
<span class="op">}</span>
<span class="va">g</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">b</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"g()\n"</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"b ="</span>, <span class="va">b</span>, <span class="st">"\n"</span><span class="op">)</span>
  <span class="fu">h</span><span class="op">(</span><span class="va">b</span><span class="op">)</span>
<span class="op">}</span>
<span class="va">h</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">c</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"i()\n"</span><span class="op">)</span>
  <span class="fu">i</span><span class="op">(</span><span class="va">c</span><span class="op">)</span>
<span class="op">}</span>

<span class="fu">f</span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>
<span class="co">#&gt; f()</span>
<span class="co">#&gt; g()</span>
<span class="co">#&gt; b = 10 </span>
<span class="co">#&gt; i()</span>
<span class="co">#&gt; [1] 20</span></code></pre></div>
<p>Print debugging is particularly useful for compiled code because it’s not uncommon for the compiler to modify your code to such an extent you can’t figure out the root problem even when inside an interactive debugger.</p>
</div>
<div id="rmarkdown" class="section level3" number="22.5.3">
<h3>
<span class="header-section-number">22.5.3</span> RMarkdown<a class="anchor" aria-label="anchor" href="#rmarkdown"><i class="fas fa-link"></i></a>
</h3>
<p></p>
<!-- Adapted from https://whattheyforgot.org/debugging-r-code.html#debugging-in-rmarkdown-documents -->
<p>Debugging code inside RMarkdown files requires some special tools. First, if you’re knitting the file using RStudio, switch to calling <code>rmarkdown::render("path/to/file.Rmd")</code> instead. This runs the code in the current session, which makes it easier to debug. If doing this makes the problem go away, you’ll need to figure out what makes the environments different.</p>
<p>If the problem persists, you’ll need to use your interactive debugging skills. Whatever method you use, you’ll need an extra step: in the error handler, you’ll need to call <code><a href="https://rdrr.io/r/base/sink.html">sink()</a></code>. This removes the default sink that knitr uses to capture all output, and ensures that you can see the results in the console. For example, to use <code><a href="https://rdrr.io/r/utils/recover.html">recover()</a></code> with RMarkdown, you’d put the following code in your setup block:</p>
<div class="sourceCode" id="cb967"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>error <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/base/sink.html">sink</a></span><span class="op">(</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/utils/recover.html">recover</a></span><span class="op">(</span><span class="op">)</span>
<span class="op">}</span><span class="op">)</span></code></pre></div>
<p>This will generate a “no sink to remove” warning when knitr completes; you can safely ignore this warning.</p>
<p>If you simply want a traceback, the easiest option is to use <code><a href="https://rlang.r-lib.org/reference/trace_back.html">rlang::trace_back()</a></code>, taking advantage of the <code>rlang_trace_top_env</code> option. This ensures that you only see the traceback from your code, instead of all the functions called by RMarkdown and knitr.</p>
<div class="sourceCode" id="cb968"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>rlang_trace_top_env <span class="op">=</span> <span class="fu">rlang</span><span class="fu">::</span><span class="fu"><a href="https://rlang.r-lib.org/reference/caller_env.html">current_env</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>error <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/base/sink.html">sink</a></span><span class="op">(</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu">rlang</span><span class="fu">::</span><span class="fu"><a href="https://rlang.r-lib.org/reference/trace_back.html">trace_back</a></span><span class="op">(</span>bottom <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sys.parent.html">sys.frame</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>, simplify <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span>
<span class="op">}</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div id="non-error-failures" class="section level2" number="22.6">
<h2>
<span class="header-section-number">22.6</span> Non-error failures<a class="anchor" aria-label="anchor" href="#non-error-failures"><i class="fas fa-link"></i></a>
</h2>
<p>


</p>
<p>There are other ways for a function to fail apart from throwing an error:</p>
<ul>
<li><p>A function may generate an unexpected warning. The easiest way to track down
warnings is to convert them into errors with <code>options(warn = 2)</code> and use the
the call stack, like <code>doWithOneRestart()</code>, <code>withOneRestart()</code>,
regular debugging tools. When you do this you’ll see some extra calls
<code><a href="https://rdrr.io/r/base/conditions.html">withRestarts()</a></code>, and <code><a href="https://rdrr.io/r/base/conditions.html">.signalSimpleWarning()</a></code>. Ignore these: they are
internal functions used to turn warnings into errors.</p></li>
<li>
<p>A function may generate an unexpected message. You can use
<code><a href="https://rlang.r-lib.org/reference/with_abort.html">rlang::with_abort()</a></code> to turn these messages into errors:</p>
<div class="sourceCode" id="cb969"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">f</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="fu">g</span><span class="op">(</span><span class="op">)</span>
<span class="va">g</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span><span class="op">(</span><span class="st">"Hi!"</span><span class="op">)</span>
<span class="fu">f</span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; Hi!</span>

<span class="fu">rlang</span><span class="fu">::</span><span class="fu"><a href="https://rlang.r-lib.org/reference/with_abort.html">with_abort</a></span><span class="op">(</span><span class="fu">f</span><span class="op">(</span><span class="op">)</span>, <span class="st">"message"</span><span class="op">)</span>
<span class="co">#&gt; Error: Hi!</span>
<span class="fu">rlang</span><span class="fu">::</span><span class="fu"><a href="https://rlang.r-lib.org/reference/last_error.html">last_trace</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; Error: Can't show last error because no error was recorded yet</span></code></pre></div>
</li>
<li><p>A function might never return. This is particularly hard to debug
automatically, but sometimes terminating the function and looking at the
<code><a href="https://rdrr.io/r/base/traceback.html">traceback()</a></code> is informative. Otherwise, use use print debugging,
as in Section <a href="debugging.html#print-debugging">22.5.2</a>.</p></li>
<li>
<p>The worst scenario is that your code might crash R completely, leaving you
with no way to interactively debug your code. This indicates a bug in
compiled (C or C++) code.</p>
<p>If the bug is in your compiled code, you’ll need to follow the links in Section
<a href="debugging.html#debug-compiled">22.4.3</a> and learn how to use an interactive C debugger
(or insert many print statements).</p>
<p>If the bug is in a package or base R, you’ll need to contact the package
maintainer. In either case, work on making the smallest possible
reproducible example (Section <a href="introduction.html#getting-help">1.7</a>) to help the developer help you.</p>
</li>
</ul>
</div>
</div>

  <div class="chapter-nav">
<div class="prev"><a href="techniques.html">Introduction</a></div>
<div class="next"><a href="perf-measure.html"><span class="header-section-number">23</span> Measuring performance</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#debugging"><span class="header-section-number">22</span> Debugging</a></li>
<li>
<a class="nav-link" href="#introduction-21"><span class="header-section-number">22.1</span> Introduction</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#outline-20">Outline</a></li></ul>
</li>
<li><a class="nav-link" href="#debugging-strategy"><span class="header-section-number">22.2</span> Overall approach</a></li>
<li>
<a class="nav-link" href="#traceback"><span class="header-section-number">22.3</span> Locating errors</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#debug-lazy"><span class="header-section-number">22.3.1</span> Lazy evaluation</a></li></ul>
</li>
<li>
<a class="nav-link" href="#browser"><span class="header-section-number">22.4</span> Interactive debugger</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#browser-commands"><span class="header-section-number">22.4.1</span> browser() commands</a></li>
<li><a class="nav-link" href="#alternatives"><span class="header-section-number">22.4.2</span> Alternatives</a></li>
<li><a class="nav-link" href="#debug-compiled"><span class="header-section-number">22.4.3</span> Compiled code</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#non-interactive-debugging"><span class="header-section-number">22.5</span> Non-interactive debugging</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#dump.frames"><span class="header-section-number">22.5.1</span> dump.frames()</a></li>
<li><a class="nav-link" href="#print-debugging"><span class="header-section-number">22.5.2</span> Print debugging</a></li>
<li><a class="nav-link" href="#rmarkdown"><span class="header-section-number">22.5.3</span> RMarkdown</a></li>
</ul>
</li>
<li><a class="nav-link" href="#non-error-failures"><span class="header-section-number">22.6</span> Non-error failures</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/hadley/adv-r/blob/master/Debugging.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/hadley/adv-r/edit/master/Debugging.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>R avanzado</strong>" was written by Jeshua Romero Guadarrama. </p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
